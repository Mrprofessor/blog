{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/setting-up-a-task-scheduler-in-flask","webpackCompilationHash":"816006a35069093f414a","result":{"data":{"markdownRemark":{"html":"<p>The first thing that comes to mind while considering a task scheduler is a cron job. As most of the today's servers are hosted on linux machines, setting a cron job for periodic task might seem like a good option for many. However in production having a crontab is nothing but a pain in the a**. It can be a bit tricky to configure different timezones depending upon the location of the server.</p>\n<p>The biggest problem with this approach is when the application is scaled into multiple web servers. In that case instead of running one we could be running multiple cron jobs which might lead to race conditions. Also it's hard to debug if something goes wrong with the task.</p>\n<p>With Flask there are multiple ways to address thid problem and <a href=\"http://www.celeryproject.org/\" target=\"_blank\" rel=\"nofollow\">Celery</a> is one of the most popular ones. Celery addresses the above problems quite gracefully. It uses same timezones of <a href=\"https://pypi.org/project/pytz/\" target=\"_blank\" rel=\"nofollow\">pytz</a> which helps in calculating timezones and setting the scheduler timings accurately.</p>\n<p>Celery uses a backend message broker (redis or RabbitMQ) to save the state of the schedule which acts as a centralized database server for multiple celery workers running on different web servers.The message broker ensures that the task is run only once as per the schedule, hence eliminating the race condition.</p>\n<p>Monitoring real time events is also supported by Celery. It includes a beautiful built-in terminal interface that shows all the current events.A nice standalone project <a href=\"https://flower.readthedocs.io/en/latest/\" target=\"_blank\" rel=\"nofollow\">Flower</a> provides a web based tool to administer Celery workers and tasks.It also supports asynchronous task execution which comes in handy for long running tasks.</p>\n<h3>Let's go hacking</h3>\n<blockquote>\n<p>Here we will be using a dockerized environment. Now the installation of redis and celery can be different from system to system and docker environments are pretty common now a days to do such kind of exercises without worrying so much about local dev infrastructure.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">flask-celery\n│   \n│  app.py\n│  docker-compose.yml\n│  Dockerfile\n│  entrypoint.sh\n│  requirements.txt\n│   \n└────────────────────────</code></pre></div>\n<p>Let's start with the Dockerfile</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> python<span class=\"token punctuation\">:</span>3.7\n\n<span class=\"token comment\"># Create a directory named flask</span>\n<span class=\"token keyword\">RUN</span> mkdir flask\n\n<span class=\"token comment\"># Copy everything to flask folder</span>\n<span class=\"token keyword\">COPY</span> . /flask/\n\n<span class=\"token comment\"># Make flask as working directory</span>\n<span class=\"token keyword\">WORKDIR</span> /flask\n\n<span class=\"token comment\"># Install the Python libraries</span>\n<span class=\"token keyword\">RUN</span> pip3 install <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>no<span class=\"token punctuation\">-</span>cache<span class=\"token punctuation\">-</span>dir <span class=\"token punctuation\">-</span>r requirements.txt\n\n<span class=\"token keyword\">EXPOSE</span> 5000\n\n<span class=\"token comment\"># Run the entrypoint script</span>\n<span class=\"token keyword\">CMD</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"bash\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"entrypoint.sh\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>The packages required for this application are mentioned in the requirement.txt file.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Flask==1.0.2\ncelery==4.3.0\nredis==3.3.11</code></pre></div>\n<p>The entry point script goes here.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\nflask run --host<span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0 --port <span class=\"token number\">5000</span></code></pre></div>\n<p>Celery uses a message broker to pass messages between the web app and celery workers. Here we will setup a Redis container which will be used as the message broker.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.7\"</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n\n  <span class=\"token key atrule\">redis</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> redis_dev_container\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> redis\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"6379:6379\"</span>\n\n  <span class=\"token key atrule\">flask_service</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> flask_dev_container\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> flask\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> \n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./\n      <span class=\"token key atrule\">dockerfile</span><span class=\"token punctuation\">:</span> Dockerfile\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> redis\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"5000:5000\"</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./<span class=\"token punctuation\">:</span>/flask\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> FLASK_DEBUG=1</code></pre></div>\n<p>Now we are all set to start our little experiment. We have a redis container running on port 6379 and a flask container running on <code class=\"language-text\">localhost:5000</code>. Let's add a simple api to test whether our tiny web application works.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask\n\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Flask-celery task scheduler!\"</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>And voila!</p>\n<div class=\"post-image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d435e077c15b91a5facf9e42dc961aa9/2b6fa/hello_scheduler.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 16.338028169014084%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAkUlEQVQI162KXQqCQAAGvVARuuibpu5qXks7SAXVTTKf8gfaXd/yIpMsdIM+GJgPxot8n2QfIZVCygwhBGEUrj9HqYI8l5SHirKsyFaXsiBNc4JAOHw/II4T1222O7xj0zCOLx5ty7PrGPqeYRjQb401BrMyW8s8W+fWGrTWrvkxTRPL8qGuG7zr7c6/djpf+AKAz7OqeLxIuwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hello scheduler\" title=\"hello scheduler\" src=\"/static/d435e077c15b91a5facf9e42dc961aa9/6ff5e/hello_scheduler.png\" srcset=\"/static/d435e077c15b91a5facf9e42dc961aa9/135ae/hello_scheduler.png 300w,\n/static/d435e077c15b91a5facf9e42dc961aa9/34e8a/hello_scheduler.png 600w,\n/static/d435e077c15b91a5facf9e42dc961aa9/6ff5e/hello_scheduler.png 1200w,\n/static/d435e077c15b91a5facf9e42dc961aa9/79a4a/hello_scheduler.png 1800w,\n/static/d435e077c15b91a5facf9e42dc961aa9/2b6fa/hello_scheduler.png 2130w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" loading=\"lazy\">\n  </a>\n    </span>\n</div>\n<p>Now we will be building a simple timer application which will show the elapsed time since the application has started. We need to configure celery with the Redis server URL and also we will be using another Redis database to store the time.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask\n<span class=\"token keyword\">from</span> celery <span class=\"token keyword\">import</span> Celery\n<span class=\"token keyword\">import</span> redis\n\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Add Redis URL configurations</span>\napp<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">\"CELERY_BROKER_URL\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"redis://redis:6379/0\"</span>\napp<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">\"CELERY_RESULT_BACKEND\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"redis://redis:6379/0\"</span>\n\n<span class=\"token comment\"># Connect Redis db</span>\nredis_db <span class=\"token operator\">=</span> redis<span class=\"token punctuation\">.</span>Redis<span class=\"token punctuation\">(</span>\n    host<span class=\"token operator\">=</span><span class=\"token string\">\"redis\"</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token string\">\"6379\"</span><span class=\"token punctuation\">,</span> db<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> charset<span class=\"token operator\">=</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">,</span> decode_responses<span class=\"token operator\">=</span><span class=\"token boolean\">True</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Initialize timer in Redis</span>\nredis_db<span class=\"token punctuation\">.</span>mset<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"minute\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"second\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Add periodic tasks</span>\ncelery_beat_schedule <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"time_scheduler\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"task\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"app.timer\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\"># Run every second</span>\n        <span class=\"token string\">\"schedule\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># Initialize Celery and update its config</span>\ncelery <span class=\"token operator\">=</span> Celery<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span>\ncelery<span class=\"token punctuation\">.</span>conf<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>\n    result_backend<span class=\"token operator\">=</span>app<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">\"CELERY_RESULT_BACKEND\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    broker_url<span class=\"token operator\">=</span>app<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">\"CELERY_BROKER_URL\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">,</span>\n    task_serializer<span class=\"token operator\">=</span><span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n    accept_content<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"json\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    result_serializer<span class=\"token operator\">=</span><span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n    beat_schedule<span class=\"token operator\">=</span>celery_beat_schedule<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Flask-celery task scheduler!\"</span>\n\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/timer\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">timer_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    time_counter <span class=\"token operator\">=</span> redis_db<span class=\"token punctuation\">.</span>mget<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"minute\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"second\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Minute: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>time_counter<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">, Second: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>time_counter<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n\n\n<span class=\"token decorator annotation punctuation\">@celery<span class=\"token punctuation\">.</span>task</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    second_counter <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>redis_db<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"second\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">if</span> second_counter <span class=\"token operator\">>=</span> <span class=\"token number\">59</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Reset the counter</span>\n        redis_db<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"second\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># Increment the minute</span>\n        redis_db<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"minute\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>redis_db<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"minute\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Increment the second</span>\n        redis_db<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"second\"</span><span class=\"token punctuation\">,</span> second_counter<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Let's update the <code class=\"language-text\">entrypoint.js</code> to run both Celery worker and beat server as background processes.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\n<span class=\"token comment\"># Run Celery worker</span>\ncelery -A app.celery worker --loglevel<span class=\"token operator\">=</span>INFO --detach --pidfile<span class=\"token operator\">=</span><span class=\"token string\">''</span>\n\n<span class=\"token comment\"># Run Celery Beat</span>\ncelery -A app.celery beat --loglevel<span class=\"token operator\">=</span>INFO --detach --pidfile<span class=\"token operator\">=</span><span class=\"token string\">''</span>\n\nflask run --host<span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0 --port <span class=\"token number\">5000</span></code></pre></div>\n<p>Our very own timer</p>\n<div class=\"post-image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/577ebe8336ac09d75d18b8758c472d54/63048/timer.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 21.654275092936803%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvklEQVQY063MTW6CYACEYc4jIJ/ViIAUm270BnoJf9oDtB6GrtoulaTyu6gJEoGk6V1IaN4SUldNuuokTzKzGUloGsOhwDBNLMtE9ASa6KLbBs7U4WbmcH1rY03GrXHDdCwUtYssq3Rkhav+AH1kNF1FWsznHN527D2POI6Jogjf9zme3sk/M84fGac8Jbso0naHUUgQBA2fJEkoy4KHxy3S5u6e/8rzyyvScrVuR13Xv339qP9WVVX74bpPfAM2YPo+Wru1BAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"timer\" title=\"timer\" src=\"/static/577ebe8336ac09d75d18b8758c472d54/6ff5e/timer.png\" srcset=\"/static/577ebe8336ac09d75d18b8758c472d54/135ae/timer.png 300w,\n/static/577ebe8336ac09d75d18b8758c472d54/34e8a/timer.png 600w,\n/static/577ebe8336ac09d75d18b8758c472d54/6ff5e/timer.png 1200w,\n/static/577ebe8336ac09d75d18b8758c472d54/79a4a/timer.png 1800w,\n/static/577ebe8336ac09d75d18b8758c472d54/63048/timer.png 2152w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" loading=\"lazy\">\n  </a>\n    </span>\n</div>\n<blockquote>\n<p>The application is only for demonstration purpose. The counter won't be accurate as the task processing time is not taken into account while calculating time.</p>\n</blockquote>\n<h3>Monitoring events</h3>\n<p>Celery has a rich support for monitoring various statistics for tasks, workers and events. We need to log into the container to enable and monitor events.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token builtin class-name\">exec</span> -it flask_dev_container <span class=\"token function\">bash</span></code></pre></div>\n<p>Enable and list all events</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">celery -A app.celery control enable_events\n\ncelery -A app.celery control events</code></pre></div>\n<p>This spins up a nice interactive terminal ui listing all the details of the scheduled tasks.</p>\n<div class=\"post-image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/44ee94eac08816a8298274ed4efdca99/b6b2e/events.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.904494382022472%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAi0lEQVQI12WNSw7CMAxEc//bIBWaJk2rrgClaf70OIPtBQKxeJIzEz+rVA4wkcglIEaPlHYUmn/IgXL/nxNZul16Nc8a2+awLEZwboLWA9bVotKR1qJQaOYshAd6T2g1frpaD3E8g4EaaZklxtxIdIW1I4bhIu9KS71nvAgW8D/v7zjPItJv+JhPE94TJMmpt+SZxAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"events\" title=\"events\" src=\"/static/44ee94eac08816a8298274ed4efdca99/6ff5e/events.png\" srcset=\"/static/44ee94eac08816a8298274ed4efdca99/135ae/events.png 300w,\n/static/44ee94eac08816a8298274ed4efdca99/34e8a/events.png 600w,\n/static/44ee94eac08816a8298274ed4efdca99/6ff5e/events.png 1200w,\n/static/44ee94eac08816a8298274ed4efdca99/79a4a/events.png 1800w,\n/static/44ee94eac08816a8298274ed4efdca99/2fb56/events.png 2400w,\n/static/44ee94eac08816a8298274ed4efdca99/b6b2e/events.png 2848w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" loading=\"lazy\">\n  </a>\n    </span>\n</div>\n<h3>Conclusion</h3>\n<p>In this post I have used Celery as an better alternative to crontabs even though the primary purpose of Celery is processing tasks queues. Both Celery worker and beat server can be run on different containers as running background processes on the web container is not regarded as best practice.</p>\n<p>Unless you are creating a stupid timer application.</p>\n<p>The above mentioned code can be found here. <a href=\"https://github.com/mrprofessor/celery-timer/\" target=\"_blank\" rel=\"nofollow\">repo</a></p>\n<p>Adios!</p>","frontmatter":{"date":"November 30, 2019","path":"/blog/setting-up-a-task-scheduler-in-flask","title":"Setting up a task scheduler in Flask"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}